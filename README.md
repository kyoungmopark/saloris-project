# saloris-project
![image](https://github.com/kyoungmopark/saloris-project/assets/103628890/04f2eba5-24c5-4f3e-816a-fb5c0db08aab)

Frontend 폴더는 CCTV를 통해 차량을 추적하고있는 영상을 웹 UI로 보여주기 위한 코드입니다. 리액트 프레임워크를 사요하였으며, 6개의 프레임에서 서버로 부터 영상처리결과를 요청하여 
실시간으로 스트리밍 받게 하였습니다.
또한 주차장 그리기 버튼을 통해 각 카메라마다 4개의 점을 클릭하면 영역이 설정되어 서버로 카메라번호와 좌표가 전송되게 만들었습니다.
주차현황보기 버튼을 통해 현재 카메라에 설젇된 주차구역에 어떤 차량(카메라마다의 트래킹 번호)이 주차되었는지 표시합니다.

allstream.py는 위와 연동되는 서버로
각 카메라마다 트래커(오픈소스 Deepsort사용)를 생성하여 트래킹합니다. 클라이언트로 부터 받은 주차장 네 좌표의 위치를 opencv로 그려서 클라이언트에 다시 보내줍니다. 또한
트래킹된 차량이 이 네좌표(Polygon)안에 있으면 Capture가 올라가고 일정 숫자 이상이 되면은 주차되었다라고 감지합니다. 그때 UDP 통신을 통해 특정 IP포트에 주차정보를 보냅니다.
마찬가지로 차량이 주차구역안에 있지않으면 capture가 줄어들고 일정 숫자 이상이 되면 빠져나왔다라고 판단해 이때 UDP 통신을 통해 출차정보를 보냅니다.

해결해야 할 점

웹 UI 업그레이드 : 좀 더 보기 편하고 사용자 친화적인 UI를 사용해야할것같습니다.
동시성 문제 : 현재 6개의 구역마다 서버로부터 스트리밍을 렌더링 받고 있는데 6개를 한번에 처리한 후 프레임을 합쳐서 클라이언트로 보내서 동시성 문제를 해결할 수 있습니다.
다만 이경우 주차구역 설정부분을 다시 설정해주어야 합니다.
카메라 간 Re-ID : 실제환경에서는 트래커로부터 현재위치, 속도정보(vx,vy), Feature정보, 카메라간 위치정보를 종합하여 Re-id를 통해 글로벌 id를 재할당하는 방식을 사용해야합니다.
그외 기능 : 주차장의 입구로 부터 특정 선을 넘어가고 안넘어가고를 trajectory를 통해 경로를 추적하여 총 차량을 추적할수있습니다. strongsort track_v5.py에 이 방식이 구현되어있습니다.
